(function(){var n={}.hasOwnProperty,t=function(t,i){function u(){this.constructor=t}for(var r in i)n.call(i,r)&&(t[r]=i[r]);return u.prototype=i.prototype,t.prototype=new u,t.__super__=i.prototype,t};ContentTools.VideoDialog=function(n){function i(){i.__super__.constructor.call(this,"Insert video")}return t(i,n),i.prototype.clearPreview=function(){if(this._domPreview)return this._domPreview.parentNode.removeChild(this._domPreview),this._domPreview=void 0},i.prototype.mount=function(){var n;return i.__super__.mount.call(this),ContentEdit.addCSSClass(this._domElement,"ct-video-dialog"),ContentEdit.addCSSClass(this._domView,"ct-video-dialog__preview"),n=this.constructor.createDiv(["ct-control-group"]),this._domControls.appendChild(n),this._domInput=document.createElement("input"),this._domInput.setAttribute("class","ct-video-dialog__input"),this._domInput.setAttribute("name","url"),this._domInput.setAttribute("placeholder",ContentEdit._("Paste YouTube or Vimeo URL")+"..."),this._domInput.setAttribute("type","text"),n.appendChild(this._domInput),this._domButton=this.constructor.createDiv(["ct-control","ct-control--text","ct-control--insert","ct-control--muted"]),this._domButton.textContent=ContentEdit._("Insert"),n.appendChild(this._domButton),this._addDOMEventListeners()},i.prototype.preview=function(n){return this.clearPreview(),this._domPreview=document.createElement("iframe"),this._domPreview.setAttribute("frameborder","0"),this._domPreview.setAttribute("height","100%"),this._domPreview.setAttribute("src",n),this._domPreview.setAttribute("width","100%"),this._domView.appendChild(this._domPreview)},i.prototype.save=function(){var n,t;return t=this._domInput.value.trim(),n=ContentTools.getEmbedVideoURL(t),n?this.dispatchEvent(this.createEvent("save",{url:n})):this.dispatchEvent(this.createEvent("save",{url:t}))},i.prototype.show=function(){return i.__super__.show.call(this),this._domInput.focus()},i.prototype.unmount=function(){return this.isMounted()&&this._domInput.blur(),i.__super__.unmount.call(this),this._domButton=null,this._domInput=null,this._domPreview=null},i.prototype._addDOMEventListeners=function(){return i.__super__._addDOMEventListeners.call(this),this._domInput.addEventListener("input",function(n){return function(t){var i;return t.target.value?ContentEdit.removeCSSClass(n._domButton,"ct-control--muted"):ContentEdit.addCSSClass(n._domButton,"ct-control--muted"),n._updatePreviewTimeout&&clearTimeout(n._updatePreviewTimeout),i=function(){var t,i;return i=n._domInput.value.trim(),t=ContentTools.getEmbedVideoURL(i),t?n.preview(t):n.clearPreview()},n._updatePreviewTimeout=setTimeout(i,500)}}(this)),this._domInput.addEventListener("keypress",function(n){return function(t){if(t.keyCode===13)return n.save()}}(this)),this._domButton.addEventListener("click",function(n){return function(t){var i;return t.preventDefault(),i=n._domButton.getAttribute("class"),i.indexOf("ct-control--muted")===-1?n.save():void 0}}(this))},i}(ContentTools.DialogUI)}).call(this);